<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>EcoS Prompt-Generator</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-50 text-gray-900 font-sans">
  <div class="max-w-3xl mx-auto p-6">
    <h1 class="text-3xl font-bold mb-4">EcoS Prompt-Generator</h1>
    <p class="mb-6 text-sm text-gray-700">
      <strong>Instructions:</strong><br>
      Select the current phase of your research project, fill in the fields, then click ‚ÄúSubmit‚Äù to generate your prompt.<br>
      You can then copy the prompt and paste it into ChatGPT, Claude, Gemini, etc.
    </p>

    <div class="space-y-6">
      <!-- Mode selector -->
      <div>
        <label for="modeSelect" class="block font-medium mb-1">Choose what to generate:</label>
        <select id="modeSelect"
                class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
          <option value="rq">1. Topic &amp; Research Question</option>
          <option value="relevance">2. Relevance Table</option>
          <option value="lit-structure">3. Literature Review Structure</option>
          <option value="literature-review">4. Literature Review</option>
          <option value="analytical-framework">5. Analytical Framework</option>
        </select>
      </div>

      <!-- 1. Topic & Research Question -->
      <div id="rq-section" class="space-y-4">
        <div>
          <label class="block font-medium">Title of the Thesis</label>
          <input id="title" type="text" maxlength="300" required
                 class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500"/>
          <div id="title-count" class="text-right text-xs text-gray-500">0 / 300</div>
        </div>
        <div>
          <label class="block font-medium">Research Question</label>
          <input id="research-question" type="text" maxlength="300" required
                 class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500"/>
          <div id="rq-count" class="text-right text-xs text-gray-500">0 / 300</div>
        </div>
      </div>

      <!-- 2. Relevance Table -->
      <div id="relevance-section" class="space-y-4 hidden">
        <div>
          <label class="block font-medium">Research Question</label>
          <input id="relevance-rq" type="text" maxlength="300" required
                 class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500"/>
          <div id="relevance-rq-count" class="text-right text-xs text-gray-500">0 / 300</div>
        </div>
        <div>
          <label class="block font-medium">Relevance Section</label>
          <textarea id="relevance" rows="6" maxlength="50000" required
                    class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500"></textarea>
          <div id="relevance-count" class="text-right text-xs text-gray-500">0 / 50000</div>
        </div>
      </div>

      <!-- 3. Literature Review Structure -->
      <div id="lit-structure-section" class="space-y-4 hidden">
        <div id="lit-structure-issues" class="space-y-4">
          <!-- Issue pairs will go here -->
        </div>
        <button id="add-issue-btn" type="button"
                class="bg-gray-200 text-gray-800 px-4 py-2 rounded-xl hover:bg-gray-300 transition">
          + Add another issue
        </button>
      </div>

      <!-- 4. Literature Review -->
      <div id="literature-review-section" class="space-y-4 hidden">
        <div>
          <label class="block font-medium">Research Question</label>
          <input id="literature-review-rq" type="text" maxlength="300" required
                 class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500"/>
          <div id="literature-review-rq-count" class="text-right text-xs text-gray-500">0 / 300</div>
        </div>
        <div>
          <label class="block font-medium">Literature Review Structure</label>
          <textarea id="literature-review-structure" rows="4" maxlength="50000" required
                    class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500"></textarea>
          <div id="literature-review-structure-count" class="text-right text-xs text-gray-500">0 / 50000</div>
        </div>
        <div>
          <label class="block font-medium">Literature Review</label>
          <textarea id="literature-review" rows="6" maxlength="50000" required
                    class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500"></textarea>
          <div id="literature-review-count" class="text-right text-xs text-gray-500">0 / 50000</div>
        </div>
      </div>

      <!-- 5. Analytical Framework -->
      <div id="analytical-framework-section" class="space-y-4 hidden">
        <div>
          <label class="block font-medium">Research Question</label>
          <input id="analytical-framework-rq" type="text" maxlength="300" required
                 class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500"/>
          <div id="analytical-framework-rq-count" class="text-right text-xs text-gray-500">0 / 300</div>
        </div>
        <div>
          <label class="block font-medium">Literature Review</label>
          <textarea id="analytical-framework-lit-review" rows="4" maxlength="50000" required
                    class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500"></textarea>
          <div id="analytical-framework-lit-review-count" class="text-right text-xs text-gray-500">0 / 50000</div>
        </div>
        <div>
          <label class="block font-medium">Analytical Framework</label>
          <textarea id="analytical-framework" rows="6" maxlength="50000" required
                    class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500"></textarea>
          <div id="analytical-framework-count" class="text-right text-xs text-gray-500">0 / 50000</div>
        </div>
      </div>

      <!-- Submit -->
      <button id="submit-btn"
              class="w-full bg-blue-600 text-white px-5 py-2 rounded-xl shadow hover:bg-blue-700 transition">
        Submit
      </button>
    </div>

    <!-- Output & Copy -->
    <div id="result" class="mt-8 whitespace-pre-wrap bg-white border border-gray-300 rounded-xl p-4 text-sm"></div>
    <button id="copy-btn"
            class="mt-4 w-full bg-green-600 text-white px-5 py-2 rounded-xl shadow hover:bg-green-700 transition hidden">
      Copy to Clipboard
    </button>
  </div>

  <script>
    // Cache
    const modeSelect = document.getElementById('modeSelect');
    const resultDiv  = document.getElementById('result');
    const copyBtn    = document.getElementById('copy-btn');
    const litIssues  = document.getElementById('lit-structure-issues');
    let issueCount   = 0;

    // Section mapping
    const sections = {
      rq:                  document.getElementById('rq-section'),
      relevance:           document.getElementById('relevance-section'),
      'lit-structure':     document.getElementById('lit-structure-section'),
      'literature-review': document.getElementById('literature-review-section'),
      'analytical-framework': document.getElementById('analytical-framework-section')
    };

    // Show/hide
    function updateSections() {
      Object.entries(sections).forEach(([k, el]) => {
        el.classList.toggle('hidden', modeSelect.value !== k);
      });
      resultDiv.textContent = '';
      copyBtn.classList.add('hidden');
    }
    modeSelect.addEventListener('change', updateSections);
    updateSections(); // initial

    // Char counters
    function setupCounter(id, countId) {
      document.getElementById(id).addEventListener('input', e => {
        document.getElementById(countId).textContent =
          `${e.target.value.length} / ${e.target.maxLength}`;
      });
    }
    [
      ['title','title-count'], ['research-question','rq-count'],
      ['relevance-rq','relevance-rq-count'], ['relevance','relevance-count'],
      ['literature-review-rq','literature-review-rq-count'],
      ['literature-review-structure','literature-review-structure-count'],
      ['literature-review','literature-review-count'],
      ['analytical-framework-rq','analytical-framework-rq-count'],
      ['analytical-framework-lit-review','analytical-framework-lit-review-count'],
      ['analytical-framework','analytical-framework-count']
    ].forEach(args => setupCounter(...args));

    // Add default 3 issues
    function addIssue() {
      issueCount++;
      const wrapper = document.createElement('div');
      wrapper.className = 'space-y-2 border-t pt-4';

      // Issue title
      const lbl1    = document.createElement('label');
      lbl1.className= 'block font-medium';
      lbl1.textContent = `Issue ${issueCount} Title`;
      const inp1    = document.createElement('input');
      inp1.type     = 'text';
      inp1.maxLength= 200;
      inp1.required = true;
      inp1.className= 'lit-issue-title w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500';
      inp1.id       = `issue-title-${issueCount}`;
      const cnt1    = document.createElement('div');
      cnt1.id      = `issue-title-count-${issueCount}`;
      cnt1.className = 'text-right text-xs text-gray-500';
      cnt1.textContent = '0 / 200';
      inp1.addEventListener('input', () => {
        cnt1.textContent = `${inp1.value.length} / ${inp1.maxLength}`;
      });

      // Issue explanation
      const lbl2    = document.createElement('label');
      lbl2.className= 'block font-medium';
      lbl2.textContent = `Issue ${issueCount} Explanation`;
      const inp2    = document.createElement('textarea');
      inp2.rows     = 3;
      inp2.maxLength= 500;
      inp2.required = true;
      inp2.className= 'lit-issue-explanation w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500';
      inp2.id       = `issue-expl-${issueCount}`;
      const cnt2    = document.createElement('div');
      cnt2.id      = `issue-expl-count-${issueCount}`;
      cnt2.className = 'text-right text-xs text-gray-500';
      cnt2.textContent = '0 / 500';
      inp2.addEventListener('input', () => {
        cnt2.textContent = `${inp2.value.length} / ${inp2.maxLength}`;
      });

      wrapper.append(lbl1, inp1, cnt1, lbl2, inp2, cnt2);
      litIssues.append(wrapper);
    }
    // init 3
    for(let i=0;i<3;i++) addIssue();

    document.getElementById('add-issue-btn')
      .addEventListener('click', addIssue);

    // Generate & copy
    document.getElementById('submit-btn').addEventListener('click', () => {
      let prompt = '';
      const mode = modeSelect.value;
      // RQ & relevance as before
      if(mode === 'rq') {
        const t = document.getElementById('title').value.trim();
        const q = document.getElementById('research-question').value.trim();
        prompt = `EcoS Prompt-Generator: Research Question\n\nTitle: "${t}"\nResearch Question: "${q}"`;
      }
      else if(mode === 'relevance') {
        const q = document.getElementById('relevance-rq').value.trim();
        const r = document.getElementById('relevance').value.trim();
        prompt = `EcoS Prompt-Generator: Relevance\n\nResearch Question: "${q}"\n\nRelevance Section:\n${r}`;
      }
      else if(mode === 'lit-structure') {
        const q = document.getElementById('lit-structure-section')
                         .querySelector('input[id^="issue-title-"]')
                         .value.trim(); // ignore, we use generic below
        // Actually get RQ from first lit-structure-rq
        const rqInput = document.getElementById('lit-structure-rq');
        const rq = rqInput ? rqInput.value.trim() : '';
        // Gather all issues
        const titles = Array.from(document.querySelectorAll('.lit-issue-title'))
                            .map(el => el.value.trim());
        const expls  = Array.from(document.querySelectorAll('.lit-issue-explanation'))
                            .map(el => el.value.trim());
        let lrsBlock = titles.map((title,i) =>
          `Issue ${i+1}: ${title}\nExplanation: ${expls[i]}`
        ).join('\n\n');
        prompt = `<PromptTemplate>
    <!-- ============ ROLE ============ -->
    <Role>
        You are acting as the professor‚Äôs assistant.
        Your sole job is to analyse students‚Äô proposed **Literature Review Structures (LRS)** and give them feedback *before* they submit to the professor.
    </Role>

    <!-- ===== PURPOSE ===== -->
    <Background>
        The **Literature Review Structure (LRS)** is a planning tool.
        It helps students identify the conceptual fields, debates, and analytical tools they will need to review in the full Literature Review (LR).
        The LR will be a **systematic review of existing scholarly work**, used to build a foundation for the student's own **Analytical Framework (AF)**.
        The AF will be derived from the literature review and represent the student's own method for answering their research question in the empirical chapter.
    </Background>

    <!-- ===== INSTRUCTIONS ===== -->
    <Instructions>
        1. Judge each LRS section only on whether it contributes directly to answering the **key analytical term** in the Research Question (RQ).
           - This key term can be multi-layered (e.g. ‚Äúeconomic statecraft strategies,‚Äù ‚Äúregional infrastructure diplomacy,‚Äù or ‚Äúsupply chain resilience policy frameworks‚Äù).
           - Everything in the literature review should help define, categorize, or provide tools for analysing this key term‚Äî**not explain it or justify it with cases**.
        2. The LRS should prepare the *how* (concepts, typologies, frameworks)‚Äî**not** the *why* (causes, drivers) or *what* (cases, results).
        3. If a section drifts into:
           ‚Ä¢ causal explanations (e.g. why states adopt certain policies)
           ‚Ä¢ historical background or timelines
           ‚Ä¢ descriptive details about countries or actors
           ‚Ä¢ findings or results from specific empirical studies
           then it must be labelled **Off-target** and reallocated to the empirical or interpretive part of the thesis.
        4. Definitions are allowed only if:
           ‚Ä¢ they clarify core terms used in the RQ, and
           ‚Ä¢ they are concise (no more than 2‚Äì3 sentences). If they become too long, redundant, or shallow, label them **Adapt**.
        5. Keep tone supportive but academically precise. Remind students that the final judgement always lies with the professor.
    </Instructions>

    <!-- ===== TAGS ===== -->
    <Tags>
        ‚úÖ On-target ‚Äì squarely supports answering the RQ‚Äôs key analytical term.
        ‚ö†Ô∏è Off-target ‚Äì does not help answer the RQ and should be cut, moved, or rethought.
        üõ†Ô∏è Adapt ‚Äì relevant but needs shortening, clearer focus, or better alignment.
        üß© Suggestion ‚Äì optional constructive improvement or clarification.
    </Tags>

    <!-- ===== EXPECTED OUTPUT ===== -->
    <ExpectedOutput>
        For **each** LRS section:
        ‚Ä¢ Begin with a tag (e.g. ‚úÖ On-target, ‚ö†Ô∏è Off-target, üõ†Ô∏è Adapt, üß© Suggestion).
        ‚Ä¢ Give a one-sentence verdict and a 1‚Äì3 sentence explanation referring to the RQ and principles.
        ‚Ä¢ End with a reminder that the professor will make the final decision.
    </ExpectedOutput>

    <!-- ===== REVIEW CRITERIA ===== -->
    <ReviewCriteria>
        1. Does the section help address the **key analytical term** in the RQ (not general background or adjacent topics)?
        2. Does it avoid causal explanation, historical narrative, or case-specific detail?
        3. Is the structure thematic and conceptual‚Äînot organized by timeline or author?
        4. Does the section show synthesis (grouping and comparing concepts), not summary lists?
        5. Does it build toward a usable **Analytical Framework (AF)** for the empirical chapter?
    </ReviewCriteria>

    <!-- ===== STUDENT INPUT ===== -->
    <ResearchQuestion>
        ${document.getElementById('lit-structure-rq').value.trim()}
    </ResearchQuestion>

    <LiteratureReview>
${lrsBlock.split('\n').map(line=>'        '+line).join('\n')}
    </LiteratureReview>
</PromptTemplate>`;
      } else if(mode === 'literature-review') {
        const q = document.getElementById('literature-review-rq').value.trim();
        const s = document.getElementById('literature-review-structure').value.trim();
        const r = document.getElementById('literature-review').value.trim();
        prompt = `EcoS Prompt-Generator: Literature Review\n\nResearch Question: "${q}"\n\nStructure:\n${s}\n\nReview:\n${r}`;
      } else if(mode === 'analytical-framework') {
        const q  = document.getElementById('analytical-framework-rq').value.trim();
        const lr = document.getElementById('analytical-framework-lit-review').value.trim();
        const af = document.getElementById('analytical-framework').value.trim();
        prompt = `EcoS Prompt-Generator: Analytical Framework\n\nResearch Question: "${q}"\n\nLiterature Review:\n${lr}\n\nAnalytical Framework:\n${af}`;
      }
      resultDiv.textContent = prompt;
      copyBtn.classList.remove('hidden');
    });

    copyBtn.addEventListener('click', () => {
      navigator.clipboard.writeText(resultDiv.textContent)
        .then(() => copyBtn.textContent = 'Copied!')
        .catch(() => copyBtn.textContent = 'Copy Failed');
    });
  </script>
</body>
</html>
