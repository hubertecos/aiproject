<!DOCTYPE html>
<html lang="en" x-data="promptGenerator()" x-bind:class="{ 'dark': dark }">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EcoS Prompt-Generator</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Alpine.js for reactivity -->
  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</head>
<body class="bg-gray-50 text-gray-900 dark:bg-gray-900 dark:text-gray-100 transition-colors duration-200">
  <div class="max-w-3xl mx-auto p-6 space-y-6">
    <!-- Header with Dark Mode Toggle -->
    <header class="flex justify-between items-center">
      <h1 class="text-3xl font-bold">EcoS Prompt-Generator</h1>
      <button @click="toggleDark()" class="p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none">
        <template x-if="!dark">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m8.66-12.34l-.7.7M4.34 19.66l-.7.7M21 12h-1M4 12H3m16.66 4.34l-.7-.7M4.34 4.34l-.7-.7" />
          </svg>
        </template>
        <template x-if="dark">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657A8 8 0 118.343 7.343a8 8 0 009.314 9.314z" />
          </svg>
        </template>
      </button>
    </header>

    <!-- Instructions -->
    <p class="text-sm text-gray-700 dark:text-gray-300">
      <strong>Instructions:</strong><br>
      Select the current phase of your research project, fill in the fields below, then click “Submit” to generate your prompt. Copy it to your preferred AI tool.
    </p>

    <!-- Mode Selector -->
    <div>
      <label for="modeSelect" class="block font-medium mb-1">What to generate</label>
      <select id="modeSelect" x-model="mode" class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500">
        <option value="rq">1. Topic &amp; Research Question</option>
        <option value="relevance">2. Relevance Table</option>
        <option value="lit-structure">3. Literature Review Structure</option>
        <option value="lit-structure-testing">3.1 Literature Review Structure (Testing)</option>
        <option value="literature-review">4. Literature Review</option>
        <option value="analytical-framework">5. Analytical Framework</option>
      </select>
    </div>

    <!-- Sections -->
    <!-- 1. RQ -->
    <section x-show="mode==='rq'" class="space-y-4" x-cloak>
      <div>
        <label class="block font-medium">Title of the Thesis</label>
        <input x-model="title" type="text" maxlength="500" placeholder="Enter your thesis title"
               class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500" />
        <div class="text-xs text-gray-500" x-text="
          title.length + ' / 500'
        "></div>
      </div>
      <div>
        <label class="block font-medium">Research Question</label>
        <input x-model="researchQuestion" type="text" maxlength="500" placeholder="Enter your research question"
               class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500" />
        <div class="text-xs text-gray-500" x-text="
          researchQuestion.length + ' / 500'
        "></div>
      </div>
    </section>

    <!-- 2. Relevance -->
    <section x-show="mode==='relevance'" class="space-y-4" x-cloak>
      <div>
        <label class="block font-medium">Research Question</label>
        <input x-model="relevanceRQ" type="text" maxlength="500" placeholder="Enter your research question"
               class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500" />
        <div class="text-xs text-gray-500" x-text="
          relevanceRQ.length + ' / 500'
        "></div>
      </div>
      <div>
        <label class="block font-medium">Relevance Section</label>
        <textarea x-model="relevance" rows="6" maxlength="50000" placeholder="Explain why this question matters"
                  class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500"></textarea>
        <div class="text-xs text-gray-500" x-text="
          relevance.length + ' / 50000'
        "></div>
      </div>
    </section>

    <!-- 3. Literature Review Structure -->
    <section x-show="mode==='lit-structure'" class="space-y-4" x-cloak>
      <div>
        <label class="block font-medium">Research Question</label>
        <input x-model="litRQ" type="text" maxlength="500" placeholder="Enter your research question"
               class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500" />
        <div class="text-xs text-gray-500" x-text="
          litRQ.length + ' / 500'
        "></div>
      </div>

      <template x-for="(issue, index) in issues" :key="index">
        <div class="space-y-2 border-t pt-4">
          <div>
            <label :for="`issue-title-${index}`" class="block font-medium">Issue {{ index + 1 }}: Title</label>
            <input :id="`issue-title-${index}`" x-model="issue.title" type="text" maxlength="500" required
                   class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-blue-500" />
          </div>
          <div>
            <label :for="`issue-expl-${index}`" class="block font-medium">Issue {{ index + 1 }}: Explanation / Purpose</label>
            <textarea :id="`issue-expl-${index}`" x-model="issue.expl" rows="4" maxlength="5000" required
                      class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-blue-500"></textarea>
          </div>
        </div>
      </template>

      <div class="flex gap-2">
        <button @click="addIssue()" type="button" class="flex-1 bg-gray-200 p-2 rounded-xl hover:bg-gray-300 focus:outline-none"
                :disabled="issues.length >= 10">+ Add issue</button>
        <button @click="removeIssue()" type="button" class="flex-1 bg-red-200 p-2 rounded-xl hover:bg-red-300 focus:outline-none"
                :disabled="issues.length <= 1">– Remove last issue</button>
      </div>
    </section>

    <!-- 3.1 Testing LRS -->
    <section x-show="mode==='lit-structure-testing'" class="space-y-4" x-cloak>
      <label class="block font-medium">Paste entire RQ + Issues here</label>
      <textarea x-model="litTesting" rows="10" maxlength="50000" placeholder="Paste RQ and all issues…"
                class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500"></textarea>
    </section>

    <!-- 4. Literature Review -->
    <section x-show="mode==='literature-review'" class="space-y-4" x-cloak>
      <div>
        <label class="block font-medium">Research Question</label>
        <input x-model="litReviewRQ" type="text" maxlength="500" placeholder="Enter your research question"
               class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500" />
        <div class="text-xs text-gray-500" x-text="
          litReviewRQ.length + ' / 500'
        "></div>
      </div>
      <div>
        <label class="block font-medium">Literature Review Structure</label>
        <textarea x-model="litReviewStructure" rows="4" maxlength="50000" placeholder="Provide your outline"
                  class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500"></textarea>
        <div class="text-xs text-gray-500" x-text="
          litReviewStructure.length + ' / 50000'
        "></div>
      </div>
      <div>
        <label class="block font-medium">Literature Review</label>
        <textarea x-model="litReview" rows="6" maxlength="50000" placeholder="Write your review"
                  class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500"></textarea>
        <div class="text-xs text-gray-500" x-text="
          litReview.length + ' / 50000'
        "></div>
      </div>
    </section>

    <!-- 5. Analytical Framework -->
    <section x-show="mode==='analytical-framework'" class="space-y-4" x-cloak>
      <div>
        <label class="block font-medium">Research Question</label>
        <input x-model="afRQ" type="text" maxlength="500" placeholder="Enter your research question"
               class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500" />
        <div class="text-xs text-gray-500" x-text="
          afRQ.length + ' / 500'
        "></div>
      </div>
      <div>
        <label class="block font-medium">Literature Review</label>
        <textarea x-model="afLitReview" rows="4" maxlength="50000" placeholder="Paste your literature review"
                  class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500"></textarea>
        <div class="text-xs text-gray-500" x-text="
          afLitReview.length + ' / 50000'
        "></div>
      </div>
      <div>
        <label class="block font-medium">Analytical Framework</label>
        <textarea x-model="af" rows="6" maxlength="50000" placeholder="Describe your analytical framework"
                  class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-500"></textarea>
        <div class="text-xs text-gray-500" x-text="
          af.length + ' / 50000'
        "></div>
      </div>
    </section>

    <!-- Submit & Output -->
    <div class="space-y-4">
      <button @click="generatePrompt()" class="w-full bg-blue-600 text-white p-3 rounded-xl hover:bg-blue-700 focus:outline-none transition">Submit</button>
      <div x-show="prompt" x-text="prompt" class="whitespace-pre-wrap bg-white dark:bg-gray-800 p-4 border border-gray-300 dark:border-gray-700 rounded-xl text-sm"></div>
      <button @click="copyPrompt()" x-show="prompt" class="w-full bg-green-600 text-white p-3 rounded-xl hover:bg-green-700 focus:outline-none transition">Copy to Clipboard</button>
    </div>
  </div>

  <script>
    function promptGenerator() {
      return {
        dark: false,
        mode: 'rq',
        title: '', researchQuestion: '',
        relevanceRQ: '', relevance: '',
        litRQ: '', issues: [{ title: '', expl: '' }, { title: '', expl: '' }, { title: '', expl: '' }],
        litTesting: '',
        litReviewRQ: '', litReviewStructure: '', litReview: '',
        afRQ: '', afLitReview: '', af: '',
        prompt: '',
        toggleDark() {
          this.dark = !this.dark;
          localStorage.setItem('dark', this.dark);
        },
        init() {
          this.dark = localStorage.getItem('dark') === 'true';
        },
        addIssue() {
          if (this.issues.length < 10) this.issues.push({ title: '', expl: '' });
        },
        removeIssue() {
          if (this.issues.length > 1) this.issues.pop();
        },
        generatePrompt() {
          let out = '';
          switch (this.mode) {
            case 'rq':
              out = `EcoS Prompt-Generator: Research Question\n\nTitle: "${this.title.trim()}"\nResearch Question: "${this.researchQuestion.trim()}"`;
              break;
            case 'relevance':
              out = `EcoS Prompt-Generator: Relevance\n\nResearch Question: "${this.relevanceRQ.trim()}"\n\nRelevance Section:\n${this.relevance.trim()}`;
              break;
            case 'lit-structure':
              const parts = this.issues
                .filter(i => i.title.trim() && i.expl.trim())
                .map(i => `Issue: ${i.title.trim()}\nExplanation / Purpose: ${i.expl.trim()}`);
              out = this.buildLitStructurePrompt(this.litRQ.trim(), parts);
              break;
            case 'lit-structure-testing':
              out = this.buildLitStructureTestingPrompt(this.litTesting.trim());
              break;
            case 'literature-review':
              out = `EcoS Prompt-Generator: Literature Review\n\nResearch Question: "${this.litReviewRQ.trim()}"\n\nStructure:\n${this.litReviewStructure.trim()}\n\nReview:\n${this.litReview.trim()}`;
              break;
            case 'analytical-framework':
              out = `EcoS Prompt-Generator: Analytical Framework\n\nResearch Question: "${this.afRQ.trim()}"\n\nLiterature Review:\n${this.afLitReview.trim()}\n\nAnalytical Framework:\n${this.af.trim()}`;
              break;
          }
          this.prompt = out;
        },
        copyPrompt() {
          navigator.clipboard.writeText(this.prompt);
          alert('Prompt copied to clipboard!');
        },
        buildLitStructurePrompt(rq, sections) {
          return `<!-- ===== ROLE ===== -->\n<Role>...student input...\n<ResearchQuestion>\n    ${rq}\n</ResearchQuestion>\n\n<LiteratureReviewStructure>\n${sections.join('\n\n')}\n</LiteratureReviewStructure>`;
        },
        buildLitStructureTestingPrompt(input) {
          return `<!-- ===== ROLE ===== -->\n<Role>...\n<PasteInputHere>\n    ${input}\n</PasteInputHere>`;
        }
      }
    }
    document.addEventListener('alpine:init', () => {
      Alpine.data('promptGenerator', promptGenerator);
    });
  </script>
</body>
</html>
